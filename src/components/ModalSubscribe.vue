<script lang="ts" setup>
import { ref } from 'vue'
import { useHelpers } from '@/useHelpers'

const { validateEmail, sendEmail } = useHelpers()
const emailInput = ref('')
const errorInput = ref(false)
const success = ref(false)

const subscribeHandler = () => {
  if (validateEmail(emailInput.value)) {
    const send = sendEmail(emailInput.value)

    if (send) {
      success.value = true
    }
  } else {
    errorInput.value = true
  }
}
</script>

<template>
  <div v-if="!success" class="modal-subscribe" @click.stop>
    <div class="bg-img">
      <svg xmlns="http://www.w3.org/2000/svg" width="199" height="41" viewBox="0 0 199 41" fill="none">
        <path d="M15.8667 39.6832C13.4993 39.6832 11.3333 39.3054 9.36889 38.5499C7.40444 37.744 5.71704 36.5603 4.30667 34.9988C2.94667 33.4373 1.88889 31.498 1.13333 29.181C0.377778 26.864 0 24.1943 0 21.1721V18.6032C0 15.7825 0.377778 13.2891 1.13333 11.1232C1.93926 8.90692 3.02222 7.04321 4.38222 5.5321C5.79259 4.02099 7.45482 2.86247 9.36889 2.05655C11.3333 1.25062 13.4993 0.847656 15.8667 0.847656C18.083 0.847656 20.0726 1.14988 21.8356 1.75432C23.5985 2.3084 25.1096 3.11432 26.3689 4.1721C27.6282 5.17951 28.6356 6.36321 29.3911 7.72321C30.1467 9.03284 30.6756 10.4432 30.9778 11.9543H25.84C25.2859 10.0906 24.2533 8.52914 22.7422 7.26988C21.2311 6.01062 19.0652 5.38099 16.2444 5.38099C13.0207 5.38099 10.3511 6.51432 8.23556 8.78099C6.17037 11.0477 5.13778 14.3217 5.13778 18.6032V21.1721C5.13778 25.8062 6.19556 29.3069 8.31111 31.6743C10.4267 33.9914 13.0711 35.1499 16.2444 35.1499C19.0652 35.1499 21.2311 34.4951 22.7422 33.1854C24.2533 31.8758 25.2859 30.0877 25.84 27.821H30.9778C30.6756 29.5336 30.1467 31.1203 29.3911 32.581C28.6356 33.9914 27.6282 35.2254 26.3689 36.2832C25.1096 37.341 23.5985 38.1721 21.8356 38.7766C20.0726 39.381 18.083 39.6832 15.8667 39.6832Z" fill="white"/>
        <path d="M48.7245 39.6832C43.6371 39.6832 39.5823 38.1217 36.56 34.9988C33.5882 31.8758 32.1023 27.3928 32.1023 21.5499V18.981C32.1023 16.1099 32.48 13.541 33.2356 11.2743C34.0415 9.00766 35.1749 7.11877 36.6356 5.60766C38.0963 4.04618 39.8341 2.86247 41.8489 2.05655C43.9141 1.25062 46.206 0.847656 48.7245 0.847656C53.8119 0.847656 57.8415 2.40914 60.8134 5.5321C63.8356 8.65507 65.3467 13.138 65.3467 18.981V21.5499C65.3467 24.421 64.9437 26.9899 64.1378 29.2565C63.3823 31.5232 62.2741 33.4373 60.8134 34.9988C59.3526 36.5099 57.5897 37.6684 55.5245 38.4743C53.5097 39.2803 51.243 39.6832 48.7245 39.6832ZM48.7245 35.1499C52.2 35.1499 54.9704 34.0166 57.0356 31.7499C59.1511 29.4832 60.2089 26.0832 60.2089 21.5499V18.981C60.2089 14.498 59.1511 11.1232 57.0356 8.85655C54.92 6.53951 52.1497 5.38099 48.7245 5.38099C45.2489 5.38099 42.4534 6.51432 40.3378 8.78099C38.2726 11.0477 37.24 14.4477 37.24 18.981V21.5499C37.24 26.0328 38.2978 29.4328 40.4134 31.7499C42.5289 34.0166 45.2993 35.1499 48.7245 35.1499Z" fill="white"/>
        <path d="M82.3319 39.6832C77.5468 39.6832 73.9957 38.6758 71.6786 36.661C69.3616 34.5958 68.0016 31.901 67.5986 28.5765H72.7364C73.1394 30.6417 74.046 32.2536 75.4564 33.4121C76.8668 34.5706 79.1586 35.1499 82.3319 35.1499C85.5557 35.1499 87.8223 34.5958 89.132 33.4877C90.492 32.3795 91.172 30.9188 91.172 29.1054C91.172 27.4936 90.5927 26.2343 89.4342 25.3277C88.326 24.421 86.9157 23.6906 85.2031 23.1365C83.5408 22.5321 81.7275 22.0032 79.7631 21.5499C77.7986 21.0462 75.9601 20.3914 74.2475 19.5854C72.5853 18.7795 71.1749 17.7217 70.0164 16.4121C68.9082 15.1025 68.3542 13.3143 68.3542 11.0477C68.3542 8.17655 69.4623 5.75877 71.6786 3.79432C73.8949 1.82988 77.1942 0.847656 81.5764 0.847656C83.8934 0.847656 85.9082 1.12469 87.6208 1.67877C89.3334 2.18247 90.769 2.88766 91.9275 3.79432C93.086 4.70099 93.9927 5.78395 94.6475 7.04321C95.3023 8.30247 95.7305 9.68766 95.932 11.1988H90.7942C90.3912 9.43581 89.5097 8.02543 88.1497 6.96766C86.7897 5.90988 84.5986 5.38099 81.5764 5.38099C78.6549 5.38099 76.5645 5.90988 75.3053 6.96766C74.0964 7.97506 73.492 9.33506 73.492 11.0477C73.492 12.5588 74.046 13.7425 75.1542 14.5988C76.3127 15.4047 77.7231 16.0847 79.3853 16.6388C81.0979 17.1425 82.9364 17.6462 84.9008 18.1499C86.8653 18.6032 88.6786 19.258 90.3408 20.1143C92.0534 20.9203 93.4638 22.0284 94.572 23.4388C95.7305 24.7988 96.3097 26.6877 96.3097 29.1054C96.3097 30.6166 96.0075 32.0269 95.4031 33.3366C94.849 34.5958 93.9927 35.704 92.8342 36.661C91.6757 37.5677 90.2149 38.298 88.452 38.8521C86.689 39.4062 84.649 39.6832 82.3319 39.6832Z" fill="white"/>
        <path d="M100.861 1.37655H104.79L105.394 7.04321H105.545C107.006 5.0284 108.693 3.4921 110.607 2.43432C112.572 1.37655 114.713 0.847656 117.03 0.847656C119.75 0.847656 122.117 1.47729 124.132 2.73655C126.147 3.99581 127.683 5.88469 128.741 8.40321C129.899 5.98544 131.562 4.12173 133.727 2.8121C135.944 1.50247 138.487 0.847656 141.359 0.847656C143.323 0.847656 145.111 1.17506 146.723 1.82988C148.335 2.48469 149.72 3.4921 150.879 4.8521C152.037 6.16173 152.919 7.79877 153.523 9.76321C154.178 11.6773 154.505 13.9188 154.505 16.4877V39.1543H149.519V16.4877C149.519 12.7603 148.687 9.98988 147.025 8.17655C145.363 6.31284 143.096 5.38099 140.225 5.38099C138.815 5.38099 137.505 5.65803 136.296 6.2121C135.087 6.71581 134.03 7.47136 133.123 8.47877C132.216 9.43581 131.486 10.5943 130.932 11.9543C130.428 13.3143 130.176 14.8254 130.176 16.4877V39.1543H125.19V16.4877C125.19 12.7603 124.359 9.98988 122.696 8.17655C121.034 6.31284 118.767 5.38099 115.896 5.38099C114.486 5.38099 113.176 5.65803 111.967 6.2121C110.759 6.71581 109.701 7.47136 108.794 8.47877C107.887 9.43581 107.157 10.5943 106.603 11.9543C106.099 13.3143 105.847 14.8254 105.847 16.4877V39.1543H100.861V1.37655Z" fill="white"/>
        <path d="M198.061 20.8477C198.061 31.8934 189.106 40.8477 178.061 40.8477C167.015 40.8477 158.061 31.8934 158.061 20.8477C158.061 9.80196 167.015 0.847656 178.061 0.847656C189.106 0.847656 198.061 9.80196 198.061 20.8477Z" fill="#FF8A00"/>
        <path d="M163.324 15.781H165.116L167.079 23.7454H167.107L168.828 15.781H171.047L172.967 23.7454H172.995L174.873 15.781H176.551L174.105 25.7365H171.886L169.952 17.7721H169.923L168.131 25.7365H165.913L163.324 15.781Z" fill="black"/>
        <path d="M177.898 15.781H179.605V25.7365H177.898V15.781Z" fill="black"/>
        <path d="M181.66 15.781H183.367V20.5739L187.122 15.781H189.198L185.728 20.1899L189.482 25.7365H187.349L184.547 21.4841L183.367 22.949V25.7365H181.66V15.781Z" fill="black"/>
        <path d="M190.759 15.781H192.466V25.7365H190.759V15.781Z" fill="black"/>
      </svg>
    </div>
    <div class="modal-subscribe__inner d-center">
      <h2>Currently site is open only for beta testers</h2>
      <p class="txt">To become the early adopter and enjoy early bird benefits, please subscribe</p>
      <input
        @input="errorInput ? errorInput = false : null"
        :class="{error: errorInput}"
        type="text" v-model="emailInput"
        placeholder="Your email">
      <p class="note">Subscribing you agree to our Policy bla bla</p>

      <button class="link bold" @click="subscribeHandler">SUBSCRIBE <span>â†’</span></button>
    </div>
  </div>
  <div v-else class="modal-subscribe--success">
    <h2>Thank you and Welcome to COSMO.WIKI Community!</h2>
    <p class="txt">You will be among the first to try advantages of Your SkinTwin Community wisdom and receive benefits of early use of functions when they become available. Please expect from us early bird invitations to get new experiences.</p>
  </div>
</template>

<style lang="scss" scoped>
h2 {
  font-size: 36px;
  font-weight: 700;

  padding-bottom: 10px;
}
.modal-subscribe {
  display: grid;
  grid-template-columns: 1fr 1fr;
  background: #fff;
  height: 80%;

  .bg-img {
    background-image: url('@/assets/img/routine/filterbg.jpeg');
    padding: 20px
  }
  &__inner {
    padding: 40px;
    flex-direction: column;

    .txt {
      max-width: 980px;

      margin: 0 auto;
      padding-bottom: 30px;
    }
    input {
      border: 1px solid $black;
      width: 450px;
      color: $grey-dark;
      background-color: transparent;
      font-size: 20px;
      transition: .3s;
      outline: none;

      padding: 12px;

      &.error {
        border-color: #cb0000;
        color: #cb0000;

        &::placeholder {
          color: #cb0000;
        }
      }
    }
    .note {
      padding: 12px 0 40px;
    }
  }

  &--success {
    max-width: 80%;
    background-image: url("@/assets/img/product/claims-bg.jpg");
    text-align: center;

    padding: 100px 40px;
  }
}
</style>
